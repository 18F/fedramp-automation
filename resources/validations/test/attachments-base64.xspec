<?xml version="1.0" encoding="UTF-8"?>

<x:description
    schematron="../src/ssp/attachments-base64.sch"
    xmlns:x="http://www.jenitennison.com/xslt/xspec">

    <x:scenario
        label="FedRAMP OSCAL SSP System Inventory">

        <x:scenario
            label="when the base64 element">

            <x:context>
                <system-security-plan
                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                    <back-matter>
                        <resource>
                            <base64
                                filename="filename.xml"
                                media-type="text/xml">stuff</base64>
                        </resource>
                    </back-matter>
                </system-security-plan>
            </x:context>

            <x:scenario
                label="is present">
                <x:expect-not-assert
                    id="resource-has-base64"
                    label="that is correct" />
            </x:scenario>

            <x:scenario
                label="is singular">
                <x:expect-not-assert
                    id="resource-has-base64-cardinality"
                    label="that is correct" />
            </x:scenario>

            <x:scenario
                label="has @filename">
                <x:expect-not-assert
                    id="base64-has-filename"
                    label="that is correct" />
            </x:scenario>

            <x:scenario
                label="has @media-type">
                <x:expect-not-assert
                    id="base64-has-media-type"
                    label="that is correct" />
            </x:scenario>

            <x:scenario
                label="has content">
                <x:expect-not-assert
                    id="base64-has-content"
                    label="that is correct" />
            </x:scenario>

        </x:scenario>

        <x:scenario
            label="when the base64 element">

            <x:context>
                <system-security-plan
                    xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                    <back-matter>
                        <resource>
                            <base64
                                filename="filename.xml"
                                media-type="text/xml">stuff</base64>
                        </resource>
                    </back-matter>
                </system-security-plan>
            </x:context>

            <x:scenario
                label="is missing">
                <x:context>
                    <system-security-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <back-matter>
                            <resource>
                                <!--<base64
                                    filename="filename.xml"
                                    media-type="text/xml">stuff</base64>-->
                            </resource>
                        </back-matter>
                    </system-security-plan>
                </x:context>
                <x:expect-assert
                    id="resource-has-base64"
                    label="that is a warning" />
            </x:scenario>

            <x:scenario
                label="is duplicative">
                <x:context>
                    <system-security-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <back-matter>
                            <resource>
                                <base64
                                    filename="filename.xml"
                                    media-type="text/xml">stuff</base64>
                                <base64
                                    filename="filename.xml"
                                    media-type="text/xml">stuff</base64>
                            </resource>
                        </back-matter>
                    </system-security-plan>
                </x:context>
                <x:expect-assert
                    id="resource-base64-cardinality"
                    label="that is error" />
            </x:scenario>

            <x:scenario
                label="lacks @filename">
                <x:context>
                    <system-security-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <back-matter>
                            <resource>
                                <base64
                                    media-type="text/xml">stuff</base64>
                            </resource>
                        </back-matter>
                    </system-security-plan>
                </x:context>
                <x:expect-assert
                    id="base64-has-filename"
                    label="that is error" />
            </x:scenario>

            <x:scenario
                label="lacks @media-type">
                <x:context>
                    <system-security-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <back-matter>
                            <resource>
                                <base64
                                    filename="filename.xml">stuff</base64>
                            </resource>
                        </back-matter>
                    </system-security-plan>
                </x:context>
                <x:expect-assert
                    id="base64-has-media-type"
                    label="that is error" />
            </x:scenario>

            <x:scenario
                label="lacks content">
                <x:context>
                    <system-security-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <back-matter>
                            <resource>
                                <base64
                                    filename="filename.xml"
                                    media-type="text/xml" />
                            </resource>
                        </back-matter>
                    </system-security-plan>
                </x:context>
                <x:expect-assert
                    id="base64-has-content"
                    label="that is error" />
            </x:scenario>

        </x:scenario>

    </x:scenario>

</x:description>
