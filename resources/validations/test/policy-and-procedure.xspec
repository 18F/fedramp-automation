<?xml version="1.0" encoding="UTF-8"?>

<x:description
    schematron="../src/ssp/policy-and-procedure.sch"
    xmlns:oscal="http://csrc.nist.gov/ns/oscal/1.0"
    xmlns:x="http://www.jenitennison.com/xslt/xspec">

    <x:scenario
        label="FedRAMP OSCAL SSP">

        <x:scenario label="for the policy facet of P&amp;P controls, ">
            
            <x:scenario
                label="when the policy link to the resource declaring the policy document attachment">

                <x:scenario
                    label="is present">
                    <x:context>
                        <system-security-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <control-implementation>
                                <implemented-requirement
                                    control-id="XX-1">
                                    <statement>
                                        <by-component>
                                            <link
                                                href="#target"
                                                rel="policy" />
                                        </by-component>
                                    </statement>
                                </implemented-requirement>
                            </control-implementation>
                            <back-matter>
                                <resource
                                    uuid="target">
                                    <prop
                                        name="type"
                                        value="policy" />
                                </resource>
                            </back-matter>
                        </system-security-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-policy-link"
                        label="that is correct" />
                </x:scenario>

                <x:scenario
                    label="is absent">
                    <x:context>
                        <system-security-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <control-implementation>
                                <implemented-requirement
                                    control-id="XX-1">
                                    <statement>
                                        <by-component>
                                            <!--<link
                                            href="#target"
                                            rel="policy" />-->
                                        </by-component>
                                    </statement>
                                </implemented-requirement>
                            </control-implementation>
                            <back-matter>
                                <resource
                                    uuid="target">
                                    <prop
                                        name="type"
                                        value="policy" />
                                </resource>
                            </back-matter>
                        </system-security-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-policy-link"
                        label="that is an error" />
                </x:scenario>

            </x:scenario>

            <x:scenario
                label="when the policy attachment resource">

                <x:scenario
                    label="is present">
                    <x:context>
                        <system-security-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <control-implementation>
                                <implemented-requirement
                                    control-id="XX-1">
                                    <statement>
                                        <by-component>
                                            <link
                                                href="#target"
                                                rel="policy" />
                                        </by-component>
                                    </statement>
                                </implemented-requirement>
                            </control-implementation>
                            <back-matter>
                                <resource
                                    uuid="target">
                                    <prop
                                        name="type"
                                        value="policy" />
                                </resource>
                            </back-matter>
                        </system-security-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-policy-attachment-resource"
                        label="that is correct" />
                </x:scenario>

                <x:scenario
                    label="is absent">
                    <x:context>
                        <system-security-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <control-implementation>
                                <implemented-requirement
                                    control-id="XX-1">
                                    <statement>
                                        <by-component>
                                            <link
                                                href="#target"
                                                rel="policy" />
                                        </by-component>
                                    </statement>
                                </implemented-requirement>
                            </control-implementation>
                            <back-matter>
                                <resource
                                    uuid="non-target">
                                    <prop
                                        name="type"
                                        value="policy" />
                                </resource>
                            </back-matter>
                        </system-security-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-policy-attachment-resource"
                        label="that is an error" />
                </x:scenario>

            </x:scenario>

        </x:scenario>



        <x:scenario label="for the procedure facet of P&amp;P controls, ">
            
            <x:scenario
                label="when the procedure link to the resource declaring the procedure document attachment">
                
                <x:scenario
                    label="is present">
                    <x:context>
                        <system-security-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <control-implementation>
                                <implemented-requirement
                                    control-id="XX-1">
                                    <statement>
                                        <by-component>
                                            <link
                                                href="#target"
                                                rel="procedure" />
                                        </by-component>
                                    </statement>
                                </implemented-requirement>
                            </control-implementation>
                            <back-matter>
                                <resource
                                    uuid="target">
                                    <prop
                                        name="type"
                                        value="procedure" />
                                </resource>
                            </back-matter>
                        </system-security-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-procedure-link"
                        label="that is correct" />
                </x:scenario>
                
                <x:scenario
                    label="is absent">
                    <x:context>
                        <system-security-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <control-implementation>
                                <implemented-requirement
                                    control-id="XX-1">
                                    <statement>
                                        <by-component>
                                            <!--<link
                                            href="#target"
                                            rel="procedure" />-->
                                        </by-component>
                                    </statement>
                                </implemented-requirement>
                            </control-implementation>
                            <back-matter>
                                <resource
                                    uuid="target">
                                    <prop
                                        name="type"
                                        value="procedure" />
                                </resource>
                            </back-matter>
                        </system-security-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-procedure-link"
                        label="that is an error" />
                </x:scenario>
                
            </x:scenario>
            
            <x:scenario
                label="when the procedure attachment resource">
                
                <x:scenario
                    label="is present">
                    <x:context>
                        <system-security-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <control-implementation>
                                <implemented-requirement
                                    control-id="XX-1">
                                    <statement>
                                        <by-component>
                                            <link
                                                href="#target"
                                                rel="procedure" />
                                        </by-component>
                                    </statement>
                                </implemented-requirement>
                            </control-implementation>
                            <back-matter>
                                <resource
                                    uuid="target">
                                    <prop
                                        name="type"
                                        value="procedure" />
                                </resource>
                            </back-matter>
                        </system-security-plan>
                    </x:context>
                    <x:expect-not-assert
                        id="has-procedure-attachment-resource"
                        label="that is correct" />
                </x:scenario>
                
                <x:scenario
                    label="is absent">
                    <x:context>
                        <system-security-plan
                            xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                            <control-implementation>
                                <implemented-requirement
                                    control-id="XX-1">
                                    <statement>
                                        <by-component>
                                            <link
                                                href="#target"
                                                rel="procedure" />
                                        </by-component>
                                    </statement>
                                </implemented-requirement>
                            </control-implementation>
                            <back-matter>
                                <resource
                                    uuid="non-target">
                                    <prop
                                        name="type"
                                        value="procedure" />
                                </resource>
                            </back-matter>
                        </system-security-plan>
                    </x:context>
                    <x:expect-assert
                        id="has-procedure-attachment-resource"
                        label="that is an error" />
                </x:scenario>
                
            </x:scenario>
            
        </x:scenario>
        
        <x:scenario label="for all P&amp;P controls, ">
            
            <x:scenario label="when no resource is re-used">
                <x:context>
                    <system-security-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <control-implementation>
                            <implemented-requirement
                                control-id="XX-1">
                                <statement>
                                    <by-component>
                                        <link
                                            href="#target1"
                                            rel="procedure" />
                                    </by-component>
                                </statement>
                            </implemented-requirement>
                            <implemented-requirement
                                control-id="YY-1">
                                <statement>
                                    <by-component>
                                        <link
                                            href="#target2"
                                            rel="procedure" />
                                    </by-component>
                                </statement>
                            </implemented-requirement>
                        </control-implementation>
                        <back-matter>
                            <resource
                                uuid="target1">
                                <prop
                                    name="type"
                                    value="procedure" />
                            </resource>
                            <resource
                                uuid="target2">
                                <prop
                                    name="type"
                                    value="procedure" />
                            </resource>
                        </back-matter>
                    </system-security-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-reuse"
                    label="that is correct" />
            </x:scenario>
            
            <x:scenario label="when a resource is re-used">
                <x:context>
                    <system-security-plan
                        xmlns="http://csrc.nist.gov/ns/oscal/1.0">
                        <control-implementation>
                            <implemented-requirement
                                control-id="XX-1">
                                <statement>
                                    <by-component>
                                        <link
                                            href="#target1"
                                            rel="procedure" />
                                    </by-component>
                                </statement>
                            </implemented-requirement>
                            <implemented-requirement
                                control-id="YY-1">
                                <statement>
                                    <by-component>
                                        <link
                                            href="#target1"
                                            rel="procedure" />
                                    </by-component>
                                </statement>
                            </implemented-requirement>
                        </control-implementation>
                        <back-matter>
                            <resource
                                uuid="target1">
                                <prop
                                    name="type"
                                    value="procedure" />
                            </resource>
                            <resource
                                uuid="target2">
                                <prop
                                    name="type"
                                    value="procedure" />
                            </resource>
                        </back-matter>
                    </system-security-plan>
                </x:context>
                <x:expect-not-assert
                    id="has-reuse"
                    label="that is an error" />
            </x:scenario>
            
        </x:scenario>

    </x:scenario>

</x:description>

